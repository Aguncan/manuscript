---
title: "Figure: the scatterblob"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Data for this figure was generated on a collaborative [google spread sheet](https://docs.google.com/spreadsheets/d/1Ls0DofQWSZQsqtP4OLFj326sGfWsklrI2tA1GNUTR6g/edit#gid=0). Cognitive load [was measured in a different file](https://docs.google.com/spreadsheets/d/1OLBR3M0uV3PMSazWUYHgPeX28wllAgS4PIlJXaNu-2o/edit#gid=0). 

Reading the data csv file:

```{r}
library(readr)
scatterblob_data <- readr::read_csv("scatterblob_data.csv")
View(scatterblob_data)
```

Creating the `my_data` object from :

```{r}
names(scatterblob_data)
scatterblob_data$x1 <- scatterblob_data$`Degree of immediate collaborativeness X1`
scatterblob_data$x2 <- scatterblob_data$`Degree of immediate collaborativeness X2`
scatterblob_data$y <- scatterblob_data$`Cognitive load absolute`

scatterblob_data$`Cognitive load` <- c(2,3,4,4.3,4.6,5,5.2,5.4,5.6,5.8,6,6.5,9,9.5)

my_data <- scatterblob_data[,c("Ways to use GitHub","y", "x1", "x2")]
my_data
```


Plotting `my_data`

```{r}
my_colors <- viridis::turbo(n = nrow(scatterblob_data))

svg(filename = "scatterblob_0.svg", width = 5, height = 8, bg = "white")
plot(x = scatterblob_data$x2, 
     y = scatterblob_data$`Cognitive load`, 
     xlab = "Immediate collaborativeness",
     ylab = "Cognitive load",
     col = "white")

for (i in seq(nrow(scatterblob_data))) {
  X0 <- scatterblob_data$x1[i]
  X1 <- scatterblob_data$x2[i]
  Y <- scatterblob_data$`Cognitive load`[i]
  if (X0 == X1) {
    points(x = X0, 
           y = Y,
           col = my_colors[i],
           pch = 19)
  text(x = X0, 
       y = Y, 
       labels = scatterblob_data$`Ways to use GitHub`[i],
       adj = 0)
  } else {
    segments(x0 = X0,
             x1 = X1,
             y0 = Y,
             col = my_colors[i],
             lwd = 15)
  text(x = median(c(X0, X1)), 
       y = Y, 
       labels = scatterblob_data$`Ways to use GitHub`[i],
       adj = 0.5)
  }
}
dev.off()
```
![First try](scatterblob_0.svg)

Distributing cognitive load evenly:

```{r}
my_colors <- viridis::turbo(n = nrow(scatterblob_data), alpha = 0.5)

svg(filename = "scatterblob.svg", width = 7, height = 9, bg = "white")
par(xpd = TRUE, mai = c(1.02, 0.82, 0.82, 2))
plot(x = c(0.1,6), 
     y = c(0.1,15), 
     xlab = "Collaborativeness",
     ylab = "Cognitive load - absolute",
     col = "white")

my_colors <- viridis::turbo(n = nrow(scatterblob_data))

for (i in seq(nrow(scatterblob_data))) {
  X0 <- my_data$x1[i]
  X1 <- my_data$x2[i]
  Y <- my_data$y[i]
  if (X0 == X1) {
    X0 <- X0 - 0.05
    X1 <- X1 + 0.05
    adj_text <- -0.1
   } else {
    adj_text <- 0.5
   }
  segments(x0 = X0,
           x1 = X1,
           y0 = Y,
           col = my_colors[i],
           lwd = 20)
   text(x = median(c(X0, X1)), 
       y = Y, 
       labels = my_data$`Ways to use GitHub`[i],
       adj = adj_text)
}
dev.off()
```

![Second try](scatterblob.svg)

